{# Projet TPI - Fabrice Maillefer #}
{# Template de base de l'application #}

{# Macro: Création d'un bouton pour le menu, style activé si la route correspond à l'url courante #}
{% macro lienSimple(titre, route_name) %}
	<li {% if route_name == app.request.attributes.get('_route') %} class="active" {% endif %}>
		<a href="{{ path(route_name) }}">
			{{ titre|raw }}
		</a>	
	</li>
{% endmacro %}

{# Macro: Formatage des nombre en format monétaire #}
{% macro monetaire(montant) %}
{{ montant|number_format(2, '.', '`')}}
{% endmacro %}

{# importation des macros de ce template en tant que "macro" #}
{% import _self as macro %}

<!DOCTYPE html>
<html>
    <head>
		<meta charset="UTF-8" />
		<title>Intranet PME {% block title %}-{% endblock %}</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<!--[if IE]>
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<![endif]-->
		<link href="{{- asset('bundles/fmrcommon/css/jquery-ui-1.10.3.custom.min.css') -}}" rel="stylesheet" type="text/css">
		<link href="{{- asset('bundles/fmrcommon/css/bootstrap.min.css') -}}" rel="stylesheet" type="text/css">		
        <script src="{{- asset('bundles/fmrcommon/js/jquery.js') -}}" type="text/javascript"></script>
     	<script src="{{- asset('bundles/fmrcommon/js/jquery-ui-1.10.3.custom.min.js') -}}" type="text/javascript"></script>
     	<script src="{{- asset('bundles/fmrcommon/js/bootstrap.min.js') -}}" type="text/javascript"></script>
     	{# Styles personalisés #}
     	<style type="text/css">
     	.form_inline_block div{
     		display: inline-block;
     	}
     	table .text-right {
			text-align: right;
		}
     	</style>
		{% block stylesheets %}{% endblock %}
		<link rel="icon" type="image/x-icon" href="{{ asset('favicon.ico') }}" />
    </head>
    <body>
		<div class="navbar">
		    <div class="navbar navbar-inverse navbar-static-top">
			      <div class="navbar-inner">
			        <div class="container-fluid">
			          <a class="btn btn-navbar" data-toggle="collapse" data-target=".navbar-collapse">
				        <span class="icon-bar"></span>
				        <span class="icon-bar"></span>
				        <span class="icon-bar"></span>
				      </a>
			          
			          <a href="{{ path('home') }}" class="brand" style="color:red;">Intranet Gestion</a>
			          {# Nom de l'utilisateur connecté #}
			          {% if is_granted("IS_AUTHENTICATED_REMEMBERED") %}
			          
			          <ul class="nav pull-right">
			              <li class="dropdown">
							 <a class="nav pull-right dropdown-toggle" id="dLabel" role="button" data-toggle="dropdown" data-target="#" href="/">
							    {{ app.user.username }}
							    <b class="caret"></b>
							 </a>
						    <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">
							    <li>
						             <a href="{{ path('fos_user_profile_show') }}">Mon profil</a>
						        </li>
						        <li>
						             <a href="/logout">Déconnexion</a>
						        </li>
						    </ul>
						    </li>
                  		</ul>
			           	
	            		{% endif %}
			          <div class="nav-collapse collapse navbar-collapse">
			            <ul class="nav">		            
							{{ macro.lienSimple("Client","client") }}
							{{ macro.lienSimple("Offre","offre") }}
							{{ macro.lienSimple("Chantier","chantier") }}
							{{ macro.lienSimple("Facture","facture") }}
			            </ul>
			           	
			          </div>
			        </div>
				</div>
			</div>
			<br />
		</div>
    	<div class="container-fluid">
    		{# Affichage des messages flash #}
			{% for type, flashMessages in app.session.flashbag.all() %}
			    {% for flashMessage in flashMessages %}
			        <div class="alert alert-{{ type }}">
			            {{ flashMessage|raw }}
			        </div>
			    {% endfor %}
			{% endfor %}
			{# Block principal du contenu #}
			{% block body %}{% endblock %}
			</div>
	        {% block javascripts %}{% endblock %}
	    </div>
    </body>
</html>